kind: pipeline
type: docker
name: unit

workspace:
  path: /cgrates

steps:
# - name: unit
#   pull: never
#   image: cgrates-integration
#   commands:
#   - go test ./utils
- name: notify
  pull: never
  image: drillster/drone-email
  settings:
    from: noreply@gmail.com
    host: smtp.gmail.com
    username:
      from_secret: email_username
    password: 
      from_secret: email_password
    subject: >
      [{{ build.status }}]
      {{ repo.owner }}/{{ repo.name }}
      ({{ commit.branch }})
    body: >
      Build number: # {{ build.number }}
      Build link: {{ build.link }}
      Build started: {{ build.started }}
      Build ended: {{ build.finished }}
      Commit author: {{ commit.author.name }}
      Commit message: {{ commit.message }}
      Commit branch: {{ commit.branch }}
      Commit link: {{ commit.link }}
    recipients:
        - arber.katellari@itsyscom.com
  when:
      status:
      - success
      - failure